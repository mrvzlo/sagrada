(function(e){function t(t){for(var o,s,r=t[0],a=t[1],l=t[2],h=0,b=[];h<r.length;h++)s=r[h],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&b.push(n[s][0]),n[s]=0;for(o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o]);u&&u(t);while(b.length)b.shift()();return i.push.apply(i,l||[]),c()}function c(){for(var e,t=0;t<i.length;t++){for(var c=i[t],o=!0,r=1;r<c.length;r++){var a=c[r];0!==n[a]&&(o=!1)}o&&(i.splice(t--,1),e=s(s.s=c[0]))}return e}var o={},n={app:0},i=[];function s(t){if(o[t])return o[t].exports;var c=o[t]={i:t,l:!1,exports:{}};return e[t].call(c.exports,c,c.exports,s),c.l=!0,c.exports}s.m=e,s.c=o,s.d=function(e,t,c){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:c})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var c=Object.create(null);if(s.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(c,o,function(t){return e[t]}.bind(null,o));return c},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/torre-di-vetro/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],a=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var u=a;i.push([0,"chunk-vendors"]),c()})({0:function(e,t,c){e.exports=c("cd49")},"019c":function(e,t,c){e.exports=c.p+"img/exit.847afc9b.svg"},"49f8":function(e,t,c){var o={"./en.json":"edd4","./ru.json":"7704"};function n(e){var t=i(e);return c(t)}function i(e){if(!c.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}n.keys=function(){return Object.keys(o)},n.resolve=i,e.exports=n,n.id="49f8"},"52d4":function(e,t,c){},7704:function(e){e.exports=JSON.parse('{"title":"Torre di Verto","easy":"Легкий","medium":"Средний","hard":"Сложный","choose":"Выберите уровень сложности","rules-btn":"Правила игры","tutorial":["Buongiorno! Это ты тот новый подмастерье? Смотри, объясняю один раз: нам привезли всего одну партию стекла на 10 частей.","Каждый день ragazzo будет притаскивать на твой выбор одну дополнительную плитку из трёх.","Твоя задача выложить витраж. Non c\'è nulla di difficile. Каждое стекло имеет толщину от 1 до 6 и один из 5 цветов. Нельзя ставить рядом две одинаковые плитки по цвету или толщине. А ну и ещё заказчик пожелал, чтобы некоторые участки имели строго определённую плитку. Tutto qui. Когда всё закончишь, вернусь и проверю."]}')},"8ed9":function(e,t,c){"use strict";c("52d4")},cd49:function(e,t,c){"use strict";c.r(t);var o,n=c("7a23"),i=c("019c"),s=c.n(i);c("14d9");(function(e){e[e["Empty"]=0]="Empty",e[e["Red"]=1]="Red",e[e["Green"]=2]="Green",e[e["Yellow"]=4]="Yellow",e[e["Blue"]=8]="Blue",e[e["Orange"]=16]="Orange",e[e["One"]=32]="One",e[e["Two"]=64]="Two",e[e["Three"]=128]="Three",e[e["Four"]=256]="Four",e[e["Five"]=512]="Five",e[e["Six"]=1024]="Six"})(o||(o={}));class r{constructor(){this.DiceCount=8,this.colors=[o.Red,o.Blue,o.Orange,o.Green,o.Yellow],this.values=[o.One,o.Two,o.Three,o.Four,o.Five,o.Six],this.generateBag=()=>{const e=[];for(let t=0;t<this.colors.length;t++)for(let c=0;c<this.DiceCount;c++){const c=this.colors[t],o=this.values[Math.floor(6*Math.random())];e.push(o|c)}return this.shuffle(e)},this.shuffleMap=e=>{const t=this.shuffle(this.colors),c=this.shuffle(this.values),n=[];for(let o=0;o<t.length;o++)n[this.colors[o]]=t[o];for(let o=0;o<c.length;o++)n[this.values[o]]=c[o];n[o.Empty]=o.Empty;for(let o=0;o<e.length;o++)e[o]=n[e[o]];return e},this.shuffle=e=>e.slice().sort(()=>Math.random()-.5)}}var a=c("f584"),l=c.n(a),u=c("ce60"),h=c.n(u);class b{constructor(){this.mode="pick",this.actions=[],this.canPick=e=>"pick"===this.mode&&!this.actions.some(t=>"pick"===t.mode&&t.public===e)}}class p{setCookie(e,t,c){const o=new Date;o.setTime(o.getTime()+24*c*60*60*1e3);const n="expires="+o.toUTCString();document.cookie=e+"="+t+";"+n+";path=/"}getCookie(e){const t=e+"=",c=document.cookie.split(";");for(let o=0;o<c.length;o++){let e=c[o];while(" "==e.charAt(0))e=e.substring(1);if(0==e.indexOf(t))return e.substring(t.length,e.length)}return""}}class d{constructor(e=o.Empty,t=!1){this.type=e,this.placed=t,this.active=!1}}var O=Object(n["j"])({__name:"dice",props:{dice:{}},setup(e){return(e,t)=>(Object(n["t"])(),Object(n["g"])("div",{class:Object(n["p"])(`dice ${e.dice.placed?"":"empty"} ${e.dice.active?"active":""} die-color-${e.dice.type%Object(n["z"])(o).One} die-value-${Math.floor(e.dice.type/Object(n["z"])(o).One)}`)},null,2))}});const f=O;var g=f;class j{constructor(){this.cheatMode=!1}markActive(e,t){const c=e.some(e=>e.placed);c?e.forEach((c,n)=>{if(c.active=this.cheatMode,c.placed)return;const i=this.getOrthogonalNeighbors(e,n),s=this.getDiagonalNeighbors(e,n);i.every(e=>!e.placed)&&s.every(e=>!e.placed)||(c.type&t)===c.type&&(i.some(e=>(e.type&t)>o.Empty)||(c.active=!0))}):e.forEach((c,n)=>{if((c.type&t)!==c.type)return;const i=this.getOrthogonalNeighbors(e,n);i.some(e=>(e.type&t)>o.Empty)||(c.active=n<5||n>=15||n%5<1||n%5>=4)})}getOrthogonalNeighbors(e,t){const c=[];return t-5>=0&&c.push(t-5),t-1>=0&&t%5!==0&&c.push(t-1),t+1<e.length&&t%5!==4&&c.push(t+1),t+5<e.length&&c.push(t+5),c.map(t=>e[t])}getDiagonalNeighbors(e,t){const c=[];return t-6>=0&&t%5!==0&&c.push(t-6),t-4>=0&&t%5!==4&&c.push(t-4),t+4<e.length&&t%5!==0&&c.push(t+4),t+6<e.length&&t%5!==4&&c.push(t+6),c.map(t=>e[t])}clearActive(e){e.forEach(e=>e.active=!1)}}class m{constructor(){this.public=[],this.private=[],this.central=[]}}const v=["onMousedown"],y={class:"dice-grid board"},k=["onMousedown"],w=["onMousedown"],x=Object(n["h"])("img",{src:l.a,alt:"confirm"},null,-1),M=[x],C=Object(n["h"])("img",{src:h.a,alt:"undo"},null,-1),E=[C],N=Object(n["h"])("div",null,"Board completed!",-1),T=Object(n["h"])("button",{class:"btn-yes"},[Object(n["h"])("img",{src:l.a,alt:"confirm"})],-1),L=[N,T],_={key:1,class:"overlay"},z={class:"text-left"},S=Object(n["h"])("img",{src:l.a,alt:"confirm"},null,-1),P=[S];var $=Object(n["j"])({__name:"grid",props:{map:{}},emits:["onEnd"],setup(e,{emit:t}){const c=e;let i=!1;const s=new r,a=new j,l=new p;let u=[];const h=Object(n["u"])(new m),O=Object(n["u"])(new b),f=Object(n["u"])({show:!1,status:0}),x=()=>{u=s.generateBag(),h.central=c.map.map(e=>new d(e)),h.private=u.splice(0,10).map(e=>new d(e,!0)),T(),i=!1,l.getCookie("show-tutorial")||(f.show=!0,f.status=0,l.setCookie("show-tutorial","true",7))},C=()=>{f.show=!0,f.status=0},N=()=>{f.status++,f.status>=3&&(f.show=!1)},T=()=>{h.public=u.splice(0,3).map(e=>new d(e,!0)),O.mode="pick",O.actions=[]},S=(e,t)=>{const c=O.canPick(t);if(!c){const c=O.actions[O.actions.length-1];return void(c.number===e&&c.public===t&&A())}const o=t?h.public[e]:h.private[e];o.placed&&(o.active=!0,O.actions.push({mode:"pick",public:t,number:e}),O.mode="place",a.markActive(h.central,o.type))},$=e=>{if(!h.central[e].active)return;const t=O.actions[O.actions.length-1];O.actions.push({mode:"place",number:e,public:t.public});const c=t.public?h.public[t.number]:h.private[t.number];h.central[e].placed=!0,h.central[e].type=c.type,c.active=!1,c.placed=!1,c.type=o.Empty,a.clearActive(h.central),O.mode="pick",h.central.every(e=>e.placed)?i=!0:4===O.actions.length&&T()},A=()=>{O.mode="pick",a.clearActive(h.central);const e=O.actions.pop();if("pick"===e.mode){const t=e.public?h.public[e.number]:h.private[e.number];return void(t.active=!1)}const t=O.actions.pop(),o=t.public?h.public[t.number]:h.private[t.number];o.placed=!0,o.type=h.central[e.number].type,h.central[e.number].placed=!1,h.central[e.number].type=c.map[e.number]},B=()=>t("onEnd");return x(),(e,t)=>(Object(n["t"])(),Object(n["g"])(n["a"],null,[Object(n["h"])("button",{class:"btn-help",onClick:C}," ❔ "),Object(n["h"])("div",{class:Object(n["p"])(["dice-grid",""+(O.canPick(!1)?"":"grid-disabled")])},[(Object(n["t"])(!0),Object(n["g"])(n["a"],null,Object(n["w"])(h.private,(e,t)=>(Object(n["t"])(),Object(n["g"])("div",{key:t,onMousedown:()=>S(t,!1)},[Object(n["i"])(g,{dice:e},null,8,["dice"])],40,v))),128))],2),Object(n["h"])("div",y,[(Object(n["t"])(!0),Object(n["g"])(n["a"],null,Object(n["w"])(h.central,(e,t)=>(Object(n["t"])(),Object(n["g"])("div",{key:t,onMousedown:()=>$(t)},[Object(n["i"])(g,{dice:e},null,8,["dice"])],40,k))),128))]),Object(n["h"])("div",{class:Object(n["p"])(["dice-grid",""+(O.canPick(!0)?"":"grid-disabled")])},[(Object(n["t"])(!0),Object(n["g"])(n["a"],null,Object(n["w"])(h.public,(e,t)=>(Object(n["t"])(),Object(n["g"])("div",{key:t,onMousedown:()=>S(t,!0)},[Object(n["i"])(g,{dice:e},null,8,["dice"])],40,w))),128))],2),Object(n["h"])("div",{class:Object(n["p"])(["toolbar",Object(n["z"])(i)?"hidden":""])},[4===O.actions.length?(Object(n["t"])(),Object(n["g"])("button",{key:0,class:"btn-yes",onClick:t[0]||(t[0]=()=>T())},M)):Object(n["f"])("",!0),O.actions.length>0?(Object(n["t"])(),Object(n["g"])("button",{key:1,class:"btn-no",onClick:t[1]||(t[1]=()=>A())},E)):Object(n["f"])("",!0)],2),Object(n["z"])(i)?(Object(n["t"])(),Object(n["g"])("div",{key:0,class:"game-over",onClick:t[2]||(t[2]=()=>B())},L)):Object(n["f"])("",!0),f.show?(Object(n["t"])(),Object(n["g"])("div",_,[Object(n["h"])("div",{class:Object(n["p"])("status-"+f.status)},[Object(n["h"])("div",z,Object(n["y"])(e.$t("tutorial."+f.status)),1),Object(n["h"])("button",{class:"btn-yes",onClick:N},P)],2)])):Object(n["f"])("",!0)],64))}});const A=$;var B=A,D=c("47e2");function F(){const e=c("49f8"),t={};return e.keys().forEach(c=>{const o=c.match(/([A-Za-z0-9-_]+)\./i);if(!o||o.length<2)return;const n=o[1];t[n]=e(c)}),t}var I=Object(D["a"])({legacy:!1,globalInjection:!0,locale:"en",fallbackLocale:"en",messages:F()});class Y{constructor(){this.locales=["ru","en"],this.nativeNames=["RU","EN"],this.current="",this.key="locale",this.cookieManager=new p;const e=this.cookieManager.getCookie(this.key);this.setLocale(e)}toggleLocale(){this.setLocale(this.nextLocale())}nextLocale(){return this.locales[this.nextLocaleId()]}nextLocaleId(){const e=this.locales.indexOf(I.global.locale.value);return(e+1)%this.locales.length}nextLocaleNativeName(){return this.nativeNames[this.nextLocaleId()]}setLocale(e){this.current=e,I.global.locale.value=e,this.cookieManager.setCookie(this.key,e,14)}}const J={class:"main"},R={class:"toolbar"},U=Object(n["h"])("img",{alt:"exit",src:s.a},null,-1),G=[U],q={key:1,class:"menu"},V=Object(n["h"])("hr",null,null,-1);var H=Object(n["j"])({__name:"app",setup(e){let t=Object(n["u"])({dice:[]});const c=new Y,o=[[0,0,0,0,0,1,0,2,0,4,0,2,0,4,0,0,0,0,0,0],[0,32,0,64,0,0,0,0,0,0,1024,0,512,0,128,0,0,256,0,0]],i=[[0,256,0,1,1024,2,0,64,0,0,0,0,2,8,32,4,1,0,0,0],[32,64,0,0,0,1,2,256,32,0,0,1,2,1024,32,1024,128,0,0,0],[1,0,1024,0,0,0,32,512,0,64,128,1,2,4,0,0,0,256,128,2],[0,1,64,0,2,0,256,0,4,0,0,0,512,2,0,8,128,0,0,16],[16,8,0,0,32,1,0,512,0,256,128,0,2,0,1,64,0,0,8,16],[0,0,1,512,0,2,256,0,4,128,102,0,0,8,0,0,16,64,0,0],[1,1024,0,0,2,0,128,1,0,0,0,512,1024,64,0,0,256,0,32,16],[16,0,8,0,4,256,2,128,1,64,0,32,0,512,0,0,0,1024,0,0],[0,0,1,0,0,64,2,512,4,32,0,8,128,16,0,32,0,1024,0,256]],s=[[0,0,512,0,0,0,128,8,64,0,256,4,1,2,32,1024,64,16,128,256],[0,1,512,2,0,1,1024,256,512,2,64,2,128,1,32,0,0,32,0,0],[1,128,0,0,0,32,1,512,0,0,0,64,1,256,512,1024,0,128,1,0],[32,0,128,1,0,0,64,1,0,0,1024,1,0,256,0,1,512,64,0,32],[1,1024,0,0,128,512,1,128,0,0,0,64,1,32,0,0,32,512,1,256],[0,0,32,1,512,0,256,1,128,0,64,1,1024,0,0,1,512,64,0,256],[32,64,256,512,0,128,512,0,0,1,1024,0,0,1,2,256,0,1,2,32],[0,512,0,128,0,0,1,256,2,0,4,64,8,1024,16,32,0,512,0,64],[1,128,2,1024,4,0,8,64,16,256,0,0,8,512,0,32,0,0,8,1024]],a=e=>l(e[Math.floor(Math.random()*e.length)]),l=e=>t.dice=(new r).shuffleMap(e),u=()=>t.dice=[],h=()=>c.toggleLocale(),b=()=>c.nextLocaleNativeName();return(e,c)=>(Object(n["t"])(),Object(n["g"])("div",J,[Object(n["h"])("div",R,[Object(n["h"])("button",{class:"btn-lang",onClick:c[0]||(c[0]=()=>h())},Object(n["y"])(b()),1),Object(n["z"])(t).dice.length?(Object(n["t"])(),Object(n["g"])("button",{key:0,class:"btn-exit",onClick:c[1]||(c[1]=()=>u())},G)):Object(n["f"])("",!0)]),Object(n["z"])(t).dice.length?(Object(n["t"])(),Object(n["e"])(B,{key:0,map:Object(n["z"])(t).dice,onOnEnd:c[2]||(c[2]=()=>u())},null,8,["map"])):Object(n["f"])("",!0),Object(n["z"])(t).dice.length?Object(n["f"])("",!0):(Object(n["t"])(),Object(n["g"])("div",q,[Object(n["h"])("h1",null,Object(n["y"])(e.$t("title")),1),Object(n["h"])("h3",null,Object(n["y"])(e.$t("choose")),1),Object(n["h"])("button",{onClick:c[3]||(c[3]=e=>a(o))},Object(n["y"])(e.$t("easy")),1),Object(n["h"])("button",{onClick:c[4]||(c[4]=e=>a(i))},Object(n["y"])(e.$t("medium")),1),Object(n["h"])("button",{onClick:c[5]||(c[5]=e=>a(s))},Object(n["y"])(e.$t("hard")),1),V]))]))}});c("8ed9");const W=H;var Z=W;Object(n["d"])(Z).use(I).mount("#app")},ce60:function(e,t,c){e.exports=c.p+"img/undo.313309a4.svg"},edd4:function(e){e.exports=JSON.parse('{"title":"Torre di Verto","choose":"Choose your difficulty level","easy":"Easy","medium":"Medium","hard":"Hard","rules-btn":"Show rules","tutorial":["Buongiorno! Are you the new apprentice? Listen, I\'ll explain it only once: we received only one batch of glass, consisting of 10 pieces.","Every day, ragazzo will bring one additional tile of three for you to choose from.","Your task is to lay out the stained glass. Non c\'è nulla di difficile. Each glass has a thickness from 1 to 6 and one of 5 colors. You cannot place two identical tiles next to each other in terms of color or thickness. Oh, and the customer also wanted some areas to have a strictly specific tile. Tutto qui. When you finish everything, I\'ll come back and check."]}')},f584:function(e,t,c){e.exports=c.p+"img/confirm.84f13676.svg"}});
//# sourceMappingURL=app.bfb1d6bc.js.map